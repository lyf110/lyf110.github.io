import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{o as e,c as a,e as n}from"./app-5f6064b2.js";const i={},d=n(`<h1 id="centos系统常见问题记录" tabindex="-1"><a class="header-anchor" href="#centos系统常见问题记录" aria-hidden="true">#</a> Centos系统常见问题记录</h1><h2 id="_1-centos用ssh登录连接缓慢处理" tabindex="-1"><a class="header-anchor" href="#_1-centos用ssh登录连接缓慢处理" aria-hidden="true">#</a> 1 centos用ssh登录连接缓慢处理</h2><h3 id="一、用ssh登录服务器-发现登录缓慢-登录一次可能需要30秒左右-于是用ssh-vvv-ip地址-查看详细登录信息-具体看那个阶段慢" tabindex="-1"><a class="header-anchor" href="#一、用ssh登录服务器-发现登录缓慢-登录一次可能需要30秒左右-于是用ssh-vvv-ip地址-查看详细登录信息-具体看那个阶段慢" aria-hidden="true">#</a> 一、用ssh登录服务器，发现登录缓慢，登录一次可能需要30秒左右，于是用ssh -vvv ip地址 查看详细登录信息 具体看那个阶段慢</h3><h3 id="二、有这几个原因" tabindex="-1"><a class="header-anchor" href="#二、有这几个原因" aria-hidden="true">#</a> 二、有这几个原因</h3><h4 id="_1、连接慢的主要原因是dns解析导致" tabindex="-1"><a class="header-anchor" href="#_1、连接慢的主要原因是dns解析导致" aria-hidden="true">#</a> 1、连接慢的主要原因是DNS解析导致</h4><h5 id="_1-、在ssh服务端上更改-etc-ssh-sshd-config文件中的配置为如下内容" tabindex="-1"><a class="header-anchor" href="#_1-、在ssh服务端上更改-etc-ssh-sshd-config文件中的配置为如下内容" aria-hidden="true">#</a> 1）、在ssh服务端上更改/etc/ssh/sshd_config文件中的配置为如下内容：</h5><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>UseDNS no
<span class="token comment"># GSSAPI options</span>
GSSAPIAuthentication no
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-、然后-执行-etc-init-d-sshd-restart重启sshd进程使上述配置生效-在连接一般就不慢" tabindex="-1"><a class="header-anchor" href="#_2-、然后-执行-etc-init-d-sshd-restart重启sshd进程使上述配置生效-在连接一般就不慢" aria-hidden="true">#</a> 2）、然后，执行/etc/init.d/sshd restart重启sshd进程使上述配置生效，在连接一般就不慢</h5><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">service</span> sshd restart
<span class="token comment"># or</span>
systemctl restart sshd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2、systemd-logind服务问题" tabindex="-1"><a class="header-anchor" href="#_2、systemd-logind服务问题" aria-hidden="true">#</a> 2、systemd-logind服务问题</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl stop systemd-logind
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_2-ssh连接服务器经常断开连接的解决方案" tabindex="-1"><a class="header-anchor" href="#_2-ssh连接服务器经常断开连接的解决方案" aria-hidden="true">#</a> 2 ssh连接服务器经常断开连接的解决方案</h2><p>在使用 ssh 连接远程服务器时，经常会遇到刚连接上还没一会就断开连接的情况，这事由于 ssh 服务特有的会话连接机制判断客户端是否存活或者长时间未产生动作而主动将其断开，这样的机制经常会存在一些误判的情况。</p><p>这样的机制可以通过设置 sshd_config 文件来修改：</p><h3 id="_2-1-打开-sshd-config-文件" tabindex="-1"><a class="header-anchor" href="#_2-1-打开-sshd-config-文件" aria-hidden="true">#</a> 2.1 打开 sshd_config 文件</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vim</span> /etc/ssh/sshd_config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-2-添加如下两行配置-保存并退出" tabindex="-1"><a class="header-anchor" href="#_2-2-添加如下两行配置-保存并退出" aria-hidden="true">#</a> 2.2 添加如下两行配置，保存并退出</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 设定每隔多少秒给 ssh 客户端发送一次信号</span>
ClientAliveInterval <span class="token number">60</span>
<span class="token comment"># 设定超过多少秒后断开与 ssh 客户端连接</span>
ClientAliveCountMax <span class="token number">86400</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>[注]：此处的配置名称需要拼写正确，如若不然则会导致 sshd 无法重启。</p></blockquote><h3 id="_2-3-重启-ssh-服务" tabindex="-1"><a class="header-anchor" href="#_2-3-重启-ssh-服务" aria-hidden="true">#</a> 2.3 重启 ssh 服务</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">service</span> sshd restart
<span class="token comment"># or</span>
systemctl restart sshd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-shell-命令行便捷修改" tabindex="-1"><a class="header-anchor" href="#_2-4-shell-命令行便捷修改" aria-hidden="true">#</a> 2.4 shell 命令行便捷修改</h4><blockquote><p>[注]：执行过 1、2、3 步骤后可跳过第 4 步，或仅使用第 4 步，一步搞定。</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^export TMOUT=.*/export TMOUT=0/&#39;</span> /etc/profile <span class="token operator">&amp;&amp;</span><span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;/#ClientAliveInterval/a\\ClientAliveInterval 60&quot;</span> /etc/ssh/sshd_config <span class="token operator">&amp;&amp;</span><span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;/#ClientAliveInterval/d&quot;</span>                        /etc/ssh/sshd_config <span class="token operator">&amp;&amp;</span><span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/ClientAliveCountMax/ s/^#//&#39;</span>                   /etc/ssh/sshd_config <span class="token operator">&amp;&amp;</span><span class="token function">sudo</span> /bin/systemctl restart sshd.service

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>亦可以将，此处命令复制写入一个 <code>shell</code> 脚本中保存使用。<br><strong>到此，重新连接该服务器将不会再频频断开连接了！</strong></p></blockquote>`,25),t=[d];function r(c,l){return e(),a("div",null,t)}const p=s(i,[["render",r],["__file","Centos7常见问题记录.html.vue"]]);export{p as default};
