import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as c,c as i,a as n,b as s,d as t,e as p}from"./app-5f6064b2.js";const l="/assets/image-20240407192427960-327-d69f1462.png",u="/assets/image-20240407192427960-328-869ad412.png",r="/assets/image-20240407192427960-329-0335667b.png",k="/assets/image-20240407192427961-330-0d39337e.png",d="/assets/image-20240407192427961-331-1ee03ada.png",v="/assets/image-20240407192427961-332-08265cca.png",m="/assets/image-20240407192427961-333-99711e93.png",b="/assets/image-20240407192427961-334-5e66295f.png",g="/assets/image-20240407192427961-335-74e43ac4.png",y="/assets/image-20240407192427961-336-aa4731bb.png",q="/assets/image-20240407192427961-337-1d603cfc.png",h="/assets/image-20240407192427961-338-ab4f95d1.gif",f="/assets/image-20240407192427961-339-2c4bf3e3.gif",w="/assets/image-20240407192427961-340-704fceed.png",_="/assets/image-20240407192427961-341-656539fb.png",T="/assets/image-20240407192427961-342-d595dc37.png",D="/assets/image-20240407192427961-343-a4008578.png",I="/assets/image-20240407192427961-344-b64b5afa.png",R="/assets/image-20240407192427962-345-731fb46d.png",E="/assets/image-20240407192427962-346-6c3c59d9.png",L="/assets/image-20240407192427962-347-008bd43d.png",A="/assets/image-20240407192427962-348-45ff938d.png",C="/assets/image-20240407192427962-349-213d8195.png",N="/assets/image-20240407192427962-350-bdb65ff2.png",j="/assets/image-20240407192427962-351-352fa033.png",x="/assets/image-20240407192427962-352-59485ea9.png",M="/assets/image-20240407192427962-353-0c6ec719.png",P="/assets/image-20240407192427962-354-37bdedce.png",S="/assets/image-20240407192427963-355-90c0a7b1.png",O="/assets/image-20240407192427963-356-da694ff8.png",z={},U=p('<h1 id="物联网智能监测-iot产品设备管理" tabindex="-1"><a class="header-anchor" href="#物联网智能监测-iot产品设备管理" aria-hidden="true">#</a> 物联网智能监测-IOT产品设备管理</h1><h2 id="_1-目标" tabindex="-1"><a class="header-anchor" href="#_1-目标" aria-hidden="true">#</a> 1 目标</h2><p>从今天开始，我们开始一个新的模块开发，叫做<strong>智能监测</strong>，我们可以先来看一张图</p><figure><img src="'+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>老人入住养老院之后，可以通过选择的配置来配备智能硬件设备，它有两类场景：安全场景和健康场景</p><ul><li>安全场景：防跌倒意外、防走失、睡眠中意外、区域滞留、环境安全</li><li>健康场景：健康监测、健康小屋；</li></ul><p>通过硬件设备来监控老人以及老人活动场所的情况。后台时刻做监控，一旦有意外发生就可以迅速处理解决。</p><p>其中关于智能设备的数据传输和上报，采用的阿里云提供的IOT物理网平台，我们也会重点讲解设备如何上报数据到IOT以及如何从IOT平台拉取数据</p><p>今日的目标：</p><ul><li>能够熟悉阿里云IOT平台的特点</li><li>能够掌握阿里云IOT平台的一些概念，如：产品、设备、物模型等</li><li>能够掌握使用阿里云IOT平台提供的接口创建设备，并绑定业务数据（老人、位置）</li><li>能够熟悉智能设备对接阿里云IOT平台上报数据的方式</li></ul><h2 id="_2-阿里云iot平台" tabindex="-1"><a class="header-anchor" href="#_2-阿里云iot平台" aria-hidden="true">#</a> 2 阿里云IOT平台</h2><p>在开发智能监测之前，我们必须要先熟悉和掌握阿里云IOT平台的使用及对接，才能开发我们的项目</p><h3 id="_2-1-什么是物联网" tabindex="-1"><a class="header-anchor" href="#_2-1-什么是物联网" aria-hidden="true">#</a> 2.1 什么是物联网</h3><p>把所有物品通过信息传感设备与互联网连接起来，进行信息交换，即物物相息，以实现智能化识别和管理。</p><p>物联网（英文：Internet of Things，缩写：IoT）起源于传媒领域，是信息科技产业的第三次革命。物联网是指通过信息传感设备，按约定的协议，将任何物体与网络相连接，物体通过信息传播媒介进行信息交换和通信，以实现智能化识别、定位、跟踪、监管等功能。</p><p>常见的应用场景：</p><ul><li></li></ul><p>共享充电宝</p><p>充电宝设备接入物联网平台后，可上报充电宝电量和借用状态等信息到物联网平台云端。充电宝用户扫码后，云端低延时向充电宝下发指令，使其弹出。同时，企业运营者能够实时获知充电宝的运行状况。</p><ul><li></li></ul><p>智能音箱</p><p>播报音箱接入物联网平台后，用户扫码完成支付后，将支付金额实时通过音箱，向用户和商家进行语音播报。</p><ul><li></li></ul><p>智能家居</p><p>智能家居技术已经成为当今家庭装潢的一大特色。比如，通过智能灯泡，可以实现远程控制灯光和电视等设备，调节温度和湿度，实现智能化生活。</p><ul><li></li></ul><p>智能农耕</p><p>智能农耕可以通过物联网技术来监测、传输、分析、管理农业生产过程中的信息。比如作物的生长情况、土壤的状况等，以提高农业生产的效率，改善利润率，减少污染，节约农业资源。</p><ul><li></li></ul><p>智能医疗</p><p>在智慧医疗中，可以捕捉人的生理状态信息，例如心跳频率、体力消耗、血压高低等。然后对采集数据进行备份、加工和分析，以便个人或医生快速查询。在物联网平台接入传感器设备，采集人体及周边环境参数的信息，通过数据服务处理数据后，反馈给用户。</p><h3 id="_2-2-iot简介" tabindex="-1"><a class="header-anchor" href="#_2-2-iot简介" aria-hidden="true">#</a> 2.2 IOT简介</h3>',32),B={href:"https://help.aliyun.com/zh/iot/product-overview/?spm=a2c4g.11186623.0.0.32d844a6NPRO9e",target:"_blank",rel:"noopener noreferrer"},V=p('<p>阿里云物联网平台是一个集成了设备管理、数据安全通信、消息订阅和数据服务等能力的一体化平台。向下支持连接海量设备，采集设备数据上云；向上提供云端API，服务端可通过调用云端API将指令下发至设备端，实现远程控制。</p><p>我们作为一个开发者，基本的设备与后台调度思路，如下：</p><figure><img src="'+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>更多的介绍可以阅读官方产品文档</p></blockquote><h3 id="_2-3-开通物联网平台" tabindex="-1"><a class="header-anchor" href="#_2-3-开通物联网平台" aria-hidden="true">#</a> 2.3 开通物联网平台</h3><h4 id="_2-3-1-开通阿里云账号" tabindex="-1"><a class="header-anchor" href="#_2-3-1-开通阿里云账号" aria-hidden="true">#</a> 2.3.1 开通阿里云账号</h4>',6),K={href:"https://www.aliyun.com/",target:"_blank",rel:"noopener noreferrer"},Q=p('<p>进入阿里云首页后，如果没有阿里云的账户需要先进行注册，才可以进行登录。由于注册较为简单，课程和讲义不在进行体现（注册可以使用多种方式，如淘宝账号、支付宝账号等...）。</p><p>需要实名认证和活体认证。</p><h4 id="_2-3-2-开通物理网平台" tabindex="-1"><a class="header-anchor" href="#_2-3-2-开通物理网平台" aria-hidden="true">#</a> 2.3.2 开通物理网平台</h4><p>登录账号以后，我们可以在产品中搜索物联网平台</p><figure><img src="'+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>打开之后，点击管理控制台</p><figure><img src="'+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如果没有开通的话，会提示你开通物联网平台，如下图，直接开通即可</p><figure><img src="'+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2-3-3-申请公共实例" tabindex="-1"><a class="header-anchor" href="#_2-3-3-申请公共实例" aria-hidden="true">#</a> 2.3.3 申请公共实例</h4><p>在IOT中分为了两种实例，一个是<strong>公共实例</strong>，另外一个是<strong>企业实例</strong>，不同的实例收费标准和功能是不一样的</p><ul><li>公共实例，免费，使用地域为<strong>上海</strong>，支持同时在线设备数为50个，最多可创建500个设备，消息通信TPS为5条/秒</li><li>企业实例，如果公共实例超出了业务需求资源，可以使用企业实例，企业实例可以按照包年包月方式计算</li></ul><p>在我们教学阶段，可以申请使用公共实例使用，如下图</p><figure><img src="'+v+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>注意：地域必须选择<strong>上海</strong>才能申请公共实例</p><h3 id="_2-4-产品" tabindex="-1"><a class="header-anchor" href="#_2-4-产品" aria-hidden="true">#</a> 2.4 产品</h3><p>一旦拥有了公共实例，我们就可以使用临时实例来进行开发，我们先来介绍产品和设备</p><h4 id="_2-4-1-创建产品" tabindex="-1"><a class="header-anchor" href="#_2-4-1-创建产品" aria-hidden="true">#</a> 2.4.1 创建产品</h4>',18),F={href:"https://help.aliyun.com/zh/iot/user-guide/create-a-product?spm=a2c4g.11186623.0.0.6ac7133dbo6zWV",target:"_blank",rel:"noopener noreferrer"},H=p('<p>产品：设备的集合，通常指一组具有相同功能的设备。物联网平台为每个产品颁发全局唯一的ProductKey。</p><p>简单说就是某一类产品，比如，手表、大门通道门禁、紧急呼叫报警器、滞留报警器、跌倒报警器</p><figure><img src="'+m+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>现在我们可以创建产品，找到产品--&gt;创建产品</p><figure><img src="'+b+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如下图，输入产品名称，然后选择平台提供好的分类，其他选择默认即可，然后确认创建</p><figure><img src="'+g+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>创建成功之后，如下图</p><figure><img src="'+y+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在产品列表中也可以查看，刚刚创建的产品</p><figure><img src="'+q+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2-4-2-物模型" tabindex="-1"><a class="header-anchor" href="#_2-4-2-物模型" aria-hidden="true">#</a> 2.4.2 物模型</h4>',12),G={href:"https://help.aliyun.com/zh/iot/user-guide/add-a-tsl-feature?spm=a2c4g.11186623.0.0.9abf6ec2jkNsER",target:"_blank",rel:"noopener noreferrer"},Y=p('<p>产品创建好之后，可以给产品添加物模型，也就是给产品定义功能。</p><p>比如我们刚才创建的手表产品，可以定义功能，功能也可以分为两类，一个是监测手表本身，一个是因为指标数据</p><ul><li></li></ul><p>手表本身：耗电量，使用时间</p><ul><li></li></ul><p>指标数据：身体血压、血氧、体温数据</p><p>像这些耗电量、血压、血氧数据都属于产品的功能，也叫做物模型</p><p>在IOT平台的物模型中，分为了三类：</p><table><thead><tr><th>功能类型</th><th>说明</th></tr></thead><tbody><tr><td>属性（Property）</td><td>用于描述设备运行时具体信息和状态。例如，环境监测设备所读取的当前环境温度、智能灯开关状态、电风扇风力等级等。属性可分为读写和只读两种类型。读写类型支持读取和设置属性值，只读类型仅支持读取属性值。</td></tr><tr><td>服务（Service）</td><td>指设备可供外部调用的指令或方法。服务调用中可设置输入和输出参数。输入参数是服务执行时的参数，输出参数是服务执行后的结果。相比于属性，服务可通过一条指令实现更复杂的业务逻辑，例如执行某项特定的任务。</td></tr><tr><td>事件（Event）</td><td>设备运行时，主动上报给云端的信息，一般包含需要被外部感知和处理的信息、告警和故障。事件中可包含多个输出参数。</td></tr><tr><td>例如，某项任务完成后的通知信息；设备发生故障时的温度、时间信息；设备告警时的运行状态等。</td><td></td></tr></tbody></table><p>创建手表产品的<strong>耗电量</strong>物模型，如下图：</p><figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_2-5-设备" tabindex="-1"><a class="header-anchor" href="#_2-5-设备" aria-hidden="true">#</a> 2.5 设备</h3>',12),J={href:"https://help.aliyun.com/zh/iot/user-guide/create-a-device?spm=a2c4g.11186623.0.0.4f1b12ackrzdOs",target:"_blank",rel:"noopener noreferrer"},Z=p('<p>产品是设备的集合，通常指一组具有相同功能的设备。创建产品完成后，需在产品下添加设备，获取设备证书。您可在物联网平台上，同时创建一个或多个设备</p><p>前提条件：设备是绑定在产品上的，所以必须先创建产品才行</p><p>操作步骤：</p><ol><li>在左侧导航栏，选择<strong>设备管理</strong>&gt; <strong>设备</strong>。</li><li>在<strong>设备</strong>页面，单击<strong>添加设备</strong>。</li><li>在<strong>添加设备</strong>对话框中，输入设备信息，单击<strong>确认</strong>。</li></ol><p>如下图：</p><figure><img src="'+f+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在添加设备的时候有三个参数，解释如下：</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>产品</td><td>选择产品。新创建的设备会继承该产品定义好的功能和特性。</td></tr><tr><td>DeviceName</td><td>设置设备名称。 设备名称在产品内具有唯一性。支持英文字母、数字、短划线（-）、下划线（_）、at（@）、英文句号（.）和英文冒号（:），长度限制为4~32个字符。</td></tr><tr><td>备注名称</td><td>设置备注名称。支持中文、英文字母、日文、数字和下划线（_），长度限制为4~64个字符，一个中文或日文占2个字符。</td></tr></tbody></table><p>创建设备成功后，会自动弹出<strong>添加完成</strong>对话框。您可以查看、复制设备证书信息。设备证书由设备的ProductKey、DeviceName和DeviceSecret组成，是设备与物联网平台进行通信的重要身份认证。</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>ProductKey</td><td>设备所属产品的ProductKey，即物联网平台为产品颁发的全局唯一标识符。</td></tr><tr><td>DeviceName</td><td>设备在产品内的唯一标识符。DeviceName与设备所属产品的ProductKey组合，作为设备标识，用来与物联网平台进行连接认证和通信。</td></tr><tr><td>DeviceSecret</td><td>物联网平台为设备颁发的设备密钥，用于认证加密。需与DeviceName成对使用。</td></tr></tbody></table><h3 id="_2-6-设备数据上报" tabindex="-1"><a class="header-anchor" href="#_2-6-设备数据上报" aria-hidden="true">#</a> 2.6 设备数据上报</h3>',11),$={href:"https://help.aliyun.com/zh/iot/user-guide/devices-retrieve-certificates/?spm=a2c4g.11186623.0.0.671b53felMSmzL",target:"_blank",rel:"noopener noreferrer"},W=p(`<p>物理设备可通过两种方式获取物联网平台颁发的设备证书（ProductKey、DeviceName和DeviceSecret）：设备厂商在产线上将证书烧录到设备上和设备上电联网后从厂商云服务中获取证书。</p><blockquote><p>物联网烧录：是指将特定的程序或数据写入物联网设备中的过程。这些设备可能包括智能家居设备、智能穿戴设备、智能传感器等。通过烧录，可以实现设备的特定功能，例如控制灯光、监测温度、收集数据等。物联网烧录需要使用专业的工具和技术，确保烧录信息的完整性和准确性，以保证设备的正常工作和稳定性。</p></blockquote><p>我们在开发阶段可以使用联网的电脑，来模拟设备的数据上报，比较简答的方式可以使用node来进行链接上报数据，参考代码如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> mqtt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;aliyun-iot-mqtt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. 设备身份信息</span>
<span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">productKey</span><span class="token operator">:</span> <span class="token string">&quot;j0rk1AN61hM&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deviceName</span><span class="token operator">:</span> <span class="token string">&quot;watch001&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deviceSecret</span><span class="token operator">:</span> <span class="token string">&quot;ea94110e5495bb04b0a7b35b9535a50c&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;iot-06z00frq8umvkx2.mqtt.iothub.aliyuncs.com&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 建立MQTT连接</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> mqtt<span class="token punctuation">.</span><span class="token function">getAliyunIotMqttClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//订阅云端指令Topic</span>
client<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>options<span class="token punctuation">.</span>productKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>options<span class="token punctuation">.</span>deviceName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/user/get</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">/sys/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>options<span class="token punctuation">.</span>productKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>options<span class="token punctuation">.</span>deviceName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/thing/event/property/post_reply</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">topic<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;topic &quot;</span> <span class="token operator">+</span> topic<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 3.定时上报温湿度数据</span>
  client<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">/sys/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>options<span class="token punctuation">.</span>productKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>options<span class="token punctuation">.</span>deviceName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/thing/event/property/post</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token function">getPostData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">qos</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> power <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getPostData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> payloadJson <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&quot;1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">PowerConsumption</span><span class="token operator">:</span> power<span class="token operator">--</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;thing.event.property.post&quot;</span>

  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;payloadJson &quot;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>payloadJson<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>payloadJson<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>把上述代码保存到一个文件夹下，以js为后缀名，如：iot_device_01.js</p><p>然后在js所在的文件夹下，打开cmd窗口，执行</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>node iot_device_01<span class="token punctuation">.</span>js
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>启动之后的效果如下：</p><figure><img src="`+w+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>设备启动后，可以在物联网平台查看刚才创建的设备，现在已在线</p><figure><img src="'+_+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>找到物模型数据，可以看到上报之后的数据</p><figure><img src="'+T+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_3-设备管理" tabindex="-1"><a class="header-anchor" href="#_3-设备管理" aria-hidden="true">#</a> 3 设备管理</h2><p>我们熟悉了IOT平台的基本概念以及基本操作后，可以现在来分析后台系统的功能需求，在后台管理系统中，是需要自己维护设备，不需要创建产品，因为产品直接物联网平台创建添加即可</p><p>需要单独维护设备的原因是，设备需要跟养老院的老人或者位置进行绑定，才能做到精准的监控</p><p>比如：</p><ul><li>烟雾报警器需要绑定到某个房间</li><li>智能手表需要绑定某个老人</li></ul><h3 id="_3-1-需求分析" tabindex="-1"><a class="header-anchor" href="#_3-1-需求分析" aria-hidden="true">#</a> 3.1 需求分析</h3><h4 id="_3-1-1-原型图位置" tabindex="-1"><a class="header-anchor" href="#_3-1-1-原型图位置" aria-hidden="true">#</a> 3.1.1 原型图位置</h4><p>我们打开原型图，找到智能监测</p><figure><img src="'+D+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_3-1-2-新增设备" tabindex="-1"><a class="header-anchor" href="#_3-1-2-新增设备" aria-hidden="true">#</a> 3.1.2 新增设备</h4><figure><img src="'+I+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这个页面跟物联网平台有些类似，但是也不同，除了物联网中的三个字段外（设备名称、所属产品、备注名称），还有<strong>接入类别</strong>和<strong>接入位置</strong></p><ul><li></li></ul><p>接入类别</p><ul><li>老人</li><li>位置</li><li></li></ul><p>接入位置</p><ul><li>如果接入类别是老人，在接入位置这边显示老人列表进行选择</li><li>如果接入类别是位置，则显示楼层、房间、床位进行选择</li></ul><h4 id="_3-1-3-设备详情" tabindex="-1"><a class="header-anchor" href="#_3-1-3-设备详情" aria-hidden="true">#</a> 3.1.3 设备详情</h4><figure><img src="'+R+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在设备详情中也可以查看物模型数据</p><figure><img src="'+E+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>当物模型的列表中，点击<strong>查看数据</strong>按钮，可以按照时间检索物模型数据</p><figure><img src="'+L+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_3-2-表结构分析" tabindex="-1"><a class="header-anchor" href="#_3-2-表结构分析" aria-hidden="true">#</a> 3.2 表结构分析</h3><p>因为在本地需要维护设备数据，所以需要在本地创建设备表，数据也要存储，也需要创建设备数据表，如下：</p><figure><img src="'+A+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>sql表结构</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;device&quot;</span> <span class="token punctuation">(</span>
  <span class="token string">&quot;id&quot;</span> <span class="token keyword">bigint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token string">&quot;device_id&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;设备ID&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;binding_location&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;绑定位置&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;location_type&quot;</span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;位置类型 0 老人 1位置&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;physical_location_type&quot;</span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;物理位置类型 0楼层 1房间 2床位&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;device_name&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;设备名称&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;note_name&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;备注名称&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;product_id&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;产品key&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;produce_name&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;产品名称&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;device_description&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;位置备注&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;create_time&quot;</span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;创建时间&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;update_time&quot;</span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;更新时间&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;is_deleted&quot;</span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;0&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;是否删除&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;create_by&quot;</span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;创建人id&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;update_by&quot;</span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;更新人id&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;remark&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;备注&#39;</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token string">&quot;binding_location_location_type_physical_location_type_product_id&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;binding_location&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;location_type&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;physical_location_type&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;product_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token string">&quot;device_id&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;device_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">133</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_unicode_ci ROW_FORMAT<span class="token operator">=</span>DYNAMIC<span class="token punctuation">;</span>


<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;device_data&quot;</span> <span class="token punctuation">(</span>
  <span class="token string">&quot;id&quot;</span> <span class="token keyword">bigint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;告警规则ID，自增主键&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;device_name&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;设备名称&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;iot_id&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;设备ID&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;note_name&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;备注名称&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;product_id&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;所属产品的key&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;product_name&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;产品名称&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;function_name&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;功能名称&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;access_location&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;接入位置&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;data_value&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;数据值&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;alarm_time&quot;</span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;报警时间&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;processing_result&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;处理结果&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;processor&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;处理人&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;processing_time&quot;</span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;处理时间&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;status&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;状态 0 正常 1 异常 2待处理 3已处理&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;create_time&quot;</span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;创建时间&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;update_time&quot;</span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;更新时间&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;create_by&quot;</span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;创建人id&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;update_by&quot;</span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;更新人id&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;remark&quot;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;备注&#39;</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token string">&quot;iot_id&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;iot_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token string">&quot;function_name&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;function_name&quot;</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">325959</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_unicode_ci ROW_FORMAT<span class="token operator">=</span>DYNAMIC<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实体类</p><p>设备实体</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>tea<span class="token punctuation">.</span></span><span class="token class-name">NameInMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>base<span class="token punctuation">.</span></span><span class="token class-name">BaseEntity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">DeviceDataVo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiModelProperty</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Device</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * 设备ID
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> deviceId<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 绑定位置
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> bindingLocation<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 位置类型 0 老人 1位置
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> locationType<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 物理位置类型 0楼层 1房间 2床位
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> physicalLocationType<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 设备名称
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> deviceName<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 位置备注
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> deviceDescription<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 是否删除
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> isDeleted<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 备注名称
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> noteName<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 产品key
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> productId<span class="token punctuation">;</span>

<span class="token comment">//    private String productName;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;设备备注名称&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;Nickname&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> nickname<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;NodeType&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> nodeType<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;Owner&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> owner<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;产品key&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;ProductKey&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> productKey<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;产品名称&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;ProductName&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> productName<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;Region&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> region<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;Status&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> status<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;UtcActive&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> utcActive<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;UtcCreate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> utcCreate<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;UtcOnline&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> utcOnline<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DeviceDataVo</span><span class="token punctuation">&gt;</span></span> deviceDataVos<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>设备数据实体</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>base<span class="token punctuation">.</span></span><span class="token class-name">BaseEntity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Builder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTime</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Builder</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeviceData</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * 接入位置
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> accessLocation<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 报警时间
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> alarmTime<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 数据值
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> dataValue<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 设备名称
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> deviceName<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 功能名称
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> functionName<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 设备ID
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> iotId<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 备注名称
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> noteName<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 处理结果
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> processingResult<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 处理时间
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> processingTime<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 处理人
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> processor<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 所属产品的key
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> productId<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 产品名称
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> productName<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 状态 0 正常 1 异常 2待处理 3已处理
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> status<span class="token punctuation">;</span>


<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-接口分析" tabindex="-1"><a class="header-anchor" href="#_3-3-接口分析" aria-hidden="true">#</a> 3.3 接口分析</h3><p>依据我们刚才的需求分析，在养老系统中需要维护设备数据，我们需要开发以下接口</p><ul><li></li></ul><p>查询所有产品列表</p><ul><li></li></ul><p>新增设备</p><ul><li></li></ul><p>查询所有设备</p><ul><li></li></ul><p>查询设备的详细信息</p><ul><li></li></ul><p>查询设备的状态</p><ul><li></li></ul><p>查询物模型功能列表</p><ul><li></li></ul><p>修改设备</p><ul><li></li></ul><p>删除设备</p><h4 id="_3-3-1-查询所有产品列表" tabindex="-1"><a class="header-anchor" href="#_3-3-1-查询所有产品列表" aria-hidden="true">#</a> 3.3.1 查询所有产品列表</h4><p><strong>接口地址</strong>:<code>/iot/QueryProductList</code></p><p><strong>请求方式</strong>:<code>POST</code></p><p><strong>请求示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;currentPage&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;操作成功&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;currentPage&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;list&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;productInfo&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token string-property property">&quot;authType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;secret&quot;</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;dataFormat&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;deviceCount&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;gmtCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1699832992000&quot;</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;nodeType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rkhjvtSko&quot;</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;productName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;智能音箱&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    <span class="token string-property property">&quot;authType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;secret&quot;</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;dataFormat&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;deviceCount&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;gmtCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1696692518000&quot;</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;nodeType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rk9ChOhVe&quot;</span><span class="token punctuation">,</span>
                    <span class="token string-property property">&quot;productName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;智能手表&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;pageCount&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">12</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-3-2-新增设备" tabindex="-1"><a class="header-anchor" href="#_3-3-2-新增设备" aria-hidden="true">#</a> 3.3.2 新增设备</h4><p><strong>接口地址</strong>:<code>/iot/RegisterDevice</code></p><p><strong>请求方式</strong>:<code>POST</code></p><p><strong>请求示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;bindingLocation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7&quot;</span><span class="token punctuation">,</span>  <span class="token comment">//绑定的位置</span>
  <span class="token string-property property">&quot;deviceDescription&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1,7&quot;</span><span class="token punctuation">,</span> <span class="token comment">//位置描述</span>
  <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yx_01&quot;</span><span class="token punctuation">,</span> <span class="token comment">//设备名称</span>
  <span class="token string-property property">&quot;locationType&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//位置类型</span>
  <span class="token string-property property">&quot;nickname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;音箱_01&quot;</span><span class="token punctuation">,</span> <span class="token comment">//设备昵称</span>
  <span class="token string-property property">&quot;physicalLocationType&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//位置类别</span>
  <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rkhjvtSko&quot;</span><span class="token punctuation">,</span><span class="token comment">//产品key</span>
  <span class="token string-property property">&quot;registerDeviceRequest&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yx_01&quot;</span><span class="token punctuation">,</span><span class="token comment">//设备名称</span>
    <span class="token string-property property">&quot;nickname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;音箱_01&quot;</span><span class="token punctuation">,</span><span class="token comment">//设备昵称</span>
    <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rkhjvtSko&quot;</span><span class="token comment">//产品key</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1楼,107&quot;</span><span class="token comment">//位置描述</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;operationTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-3-3-查询所有设备" tabindex="-1"><a class="header-anchor" href="#_3-3-3-查询所有设备" aria-hidden="true">#</a> 3.3.3 查询所有设备</h4><p><strong>接口地址</strong>:<code>/iot/QueryDevice</code></p><p><strong>请求方式</strong>:<code>POST</code></p><p><strong>请求示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;currentPage&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token comment">//产品key</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;操作成功&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;records&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;140&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;createTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13 10:43:10&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;updateTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13 10:43:10&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;createBy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1671403256519078138&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;哈哈&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;creator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;超级管理员&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;locationType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;bindingLocation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;139&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;watch_03&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;physicalLocationType&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ozgUYc3PSd239inJNiRY&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceSecret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;18d225b629e401b3faa999a9be62359d&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;gmtCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Fri, 13-Oct-2023 02:43:10 GMT&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;iotId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ozgUYc3PSd239inJNiRYj0rk00&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;nickname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;智能手表03&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rkM5mCanO&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;productName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;健康定位报警手表&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;utcCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13T02:43:10.000Z&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;139&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;createTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13 10:42:44&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;updateTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13 10:42:44&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;createBy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1671403256519078138&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;陈康伯&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;creator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;超级管理员&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;locationType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;bindingLocation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;140&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;watch_02&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;physicalLocationType&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UJZar5CPXXGDL2X1NjI9&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceSecret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4d822b5f5d29321abceda70cd6b6cada&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;gmtCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Fri, 13-Oct-2023 02:42:44 GMT&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;iotId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UJZar5CPXXGDL2X1NjI9j0rk00&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;nickname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;智能手表02&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rkM5mCanO&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;productName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;健康定位报警手表&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;utcCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13T02:42:44.000Z&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;137&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;createTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-11 14:34:32&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;createBy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1671403256519078138&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;马克&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;creator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;超级管理员&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;locationType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;bindingLocation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;134&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;watch_08&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;physicalLocationType&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OJrGD42y7A0L0WVL7EBw&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;deviceSecret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;06e979fb4e9a62867c219f1d5c194481&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;gmtCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Wed, 11-Oct-2023 06:34:32 GMT&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;iotId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OJrGD42y7A0L0WVL7EBwj0rk00&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;nickname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;智能定位手表&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rkM5mCanO&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;productName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;健康定位报警手表&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;utcCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-11T06:34:32.000Z&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-3-4-查询设备的详细信息" tabindex="-1"><a class="header-anchor" href="#_3-3-4-查询设备的详细信息" aria-hidden="true">#</a> 3.3.4 查询设备的详细信息</h4><p><strong>接口地址</strong>:<code>/iot/QueryDeviceDetail</code></p><p><strong>请求方式</strong>:<code>POST</code></p><p><strong>请求示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;iotId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;操作成功&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;140&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;createTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13 10:43:10&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;updateTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13 10:43:10&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;createBy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1671403256519078138&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;哈哈&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;creator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;超级管理员&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;locationType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;bindingLocation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;139&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;watch_03&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;physicalLocationType&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;deviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ozgUYc3PSd239inJNiRYj0rk00&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;deviceSecret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;18d225b629e401b3faa999a9be62359d&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;gmtActive&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;gmtCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13 10:43:10&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;gmtOnline&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;iotId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ozgUYc3PSd239inJNiRYj0rk00&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;nickname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;智能手表03&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;nodeType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rkM5mCanO&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;productName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;健康定位报警手表&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;region&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cn-shanghai&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UNACTIVE&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;utcActive&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;utcCreate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-10-13T02:43:10.000Z&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;utcOnline&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-3-5-查询设备的状态" tabindex="-1"><a class="header-anchor" href="#_3-3-5-查询设备的状态" aria-hidden="true">#</a> 3.3.5 查询设备的状态</h4><p><strong>接口地址</strong>:<code>/iot/QueryDevicePropertyStatus</code></p><p><strong>请求方式</strong>:<code>POST</code></p><p><strong>请求示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;operationTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-3-6-查询物模型功能列表" tabindex="-1"><a class="header-anchor" href="#_3-3-6-查询物模型功能列表" aria-hidden="true">#</a> 3.3.6 查询物模型功能列表</h4><p><strong>接口地址</strong>:<code>/iot/QueryThingModelPublished</code></p><p><strong>请求方式</strong>:<code>POST</code></p><p><strong>请求示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;operationTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-3-7-修改设备" tabindex="-1"><a class="header-anchor" href="#_3-3-7-修改设备" aria-hidden="true">#</a> 3.3.7 修改设备</h4><p><strong>接口地址</strong>:<code>/iot/UpdateDevice</code></p><p><strong>请求方式</strong>:<code>POST</code></p><p><strong>请求示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;bindingLocation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span>  <span class="token comment">//绑定的位置</span>
  <span class="token string-property property">&quot;deviceDescription&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1,7,10&quot;</span><span class="token punctuation">,</span> <span class="token comment">//位置具体参数</span>
  <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ds_03&quot;</span><span class="token punctuation">,</span> <span class="token comment">//设备名称</span>
  <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;149&quot;</span><span class="token punctuation">,</span> <span class="token comment">//主键</span>
  <span class="token string-property property">&quot;iotId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LK0dHs1covCX1Zsf2j95j0rk00&quot;</span><span class="token punctuation">,</span><span class="token comment">//设备id</span>
  <span class="token string-property property">&quot;locationType&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">//位置列表  0 老人   1 位置</span>
  <span class="token string-property property">&quot;nickname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;电视8号&quot;</span><span class="token punctuation">,</span> <span class="token comment">//设备昵称</span>
  <span class="token string-property property">&quot;physicalLocationType&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">//物理位置</span>
  <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rk7e6hJkx&quot;</span><span class="token punctuation">,</span> <span class="token comment">//产品key</span>
  <span class="token string-property property">&quot;registerDeviceRequest&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">//注册设备请求对象</span>
    <span class="token string-property property">&quot;deviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ds_03&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;nickname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;电视8号&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;j0rk7e6hJkx&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1楼,107,107-1&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;operationTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-3-8-删除设备" tabindex="-1"><a class="header-anchor" href="#_3-3-8-删除设备" aria-hidden="true">#</a> 3.3.8 删除设备</h4><p><strong>接口地址</strong>:<code>/iot/DeleteDevice</code></p><p><strong>请求方式</strong>:<code>DELETE</code></p><p><strong>请求示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;iotId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;productKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应示例</strong>:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;operationTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-iot接口对接" tabindex="-1"><a class="header-anchor" href="#_3-4-iot接口对接" aria-hidden="true">#</a> 3.4 IOT接口对接</h3><p>我们刚才分析了功能中涉及到的接口，其中关于设备的维护（新增、删除、修改、查询），我们都需要在IOT平台中去操作，同时也需要在本地去保存一份，那为什么要保存两份呢？</p><p>IOT平台中只是维护了基础的设备信息，并没有跟业务数据进行绑定，比如，设备属于哪个位置，绑定了哪个老人。</p><p>只有设备绑定了业务数据，后期采集数据之后，我们才能针对性的进行排查问题。</p><p>所以，在接口的开发中，我们需要调用远程的接口维护设备，同时也需要在本地进行数据操作。关于远程接口，IOT平台给提供了丰富的API，利于我们去操作。</p><h4 id="_3-4-1-api列表" tabindex="-1"><a class="header-anchor" href="#_3-4-1-api列表" aria-hidden="true">#</a> 3.4.1 API列表</h4><p>API列表：</p>`,127),X={href:"https://help.aliyun.com/zh/iot/developer-reference/list-of-operations-by-function?spm=a2c4g.11186623.0.0.23ba960eDJ24rh",target:"_blank",rel:"noopener noreferrer"},nn=n("p",null,"目前业务中所需要的接口文档如下：",-1),sn=n("p",null,"产品管理的API",-1),an={href:"https://help.aliyun.com/zh/iot/developer-reference/api-f8df77#reference-tts-44z-wdb",target:"_blank",rel:"noopener noreferrer"},tn=n("p",null,"设备管理的API",-1),pn={href:"https://help.aliyun.com/zh/iot/developer-reference/api-4e1b88",target:"_blank",rel:"noopener noreferrer"},en={href:"https://help.aliyun.com/zh/iot/developer-reference/api-6957f2",target:"_blank",rel:"noopener noreferrer"},on={href:"https://help.aliyun.com/zh/iot/developer-reference/api-querydevice-2018-01-20",target:"_blank",rel:"noopener noreferrer"},cn={href:"https://help.aliyun.com/zh/iot/developer-reference/api-f67546",target:"_blank",rel:"noopener noreferrer"},ln={href:"https://help.aliyun.com/zh/iot/developer-reference/api-d657a4",target:"_blank",rel:"noopener noreferrer"},un={href:"https://help.aliyun.com/zh/iot/developer-reference/api-211c0f",target:"_blank",rel:"noopener noreferrer"},rn=n("p",null,"物模型管理的API",-1),kn={href:"https://help.aliyun.com/zh/iot/developer-reference/api-querythingmodelpublished#doc-api-Iot-QueryThingModelPublished",target:"_blank",rel:"noopener noreferrer"},dn=n("h4",{id:"_3-4-2-环境集成",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_3-4-2-环境集成","aria-hidden":"true"},"#"),s(" 3.4.2 环境集成")],-1),vn=n("p",null,"IOT平台目前已经给提供了完整的SDK，我们可以快速集成到项目进行接口的调用，集成方式链接如下：",-1),mn={href:"https://help.aliyun.com/zh/iot/developer-reference/use-iot-platform-sdk-for-java-1?spm=a2c4g.11186623.0.0.4de85c09n2V2vb",target:"_blank",rel:"noopener noreferrer"},bn=p(`<p>在zzyl-service模块导入坐标</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/com.aliyun/iot20180120 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>iot20180120<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tea-openapi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在application.yml文件中添加关于IOT的配置如下：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">zzyl</span><span class="token punctuation">:</span>
  <span class="token key atrule">aliyun</span><span class="token punctuation">:</span>
    <span class="token key atrule">accessKeyId</span><span class="token punctuation">:</span> LTAI5tDQKg9F61aJhbmhqVRK
    <span class="token key atrule">accessKeySecret</span><span class="token punctuation">:</span> LYUKZH7HQGBoD025pmSq0fQsREaOYD
    <span class="token key atrule">consumerGroupId</span><span class="token punctuation">:</span> DEFAULT_GROUP
    <span class="token key atrule">regionId</span><span class="token punctuation">:</span> cn<span class="token punctuation">-</span>shanghai
    <span class="token key atrule">iotInstanceId</span><span class="token punctuation">:</span> iot<span class="token punctuation">-</span>06z00frq8umvkx2
    <span class="token key atrule">host</span><span class="token punctuation">:</span> iot<span class="token punctuation">-</span>06z00frq8umvkx2.amqp.iothub.aliyuncs.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>accessKeyId：阿里云账号的秘钥KEY</p></blockquote><blockquote><p>accessKeySecret：阿里云账号的秘钥</p></blockquote><blockquote><p>consumerGroupId：消费组，默认是DEFAULT_GROUP，后期接收数据使用</p></blockquote><blockquote><p>regionId：区域ID，公共实例默认都是cn-shanghai</p></blockquote><blockquote><p>iotInstanceId：公共实例ID</p></blockquote><blockquote><p>host：前面公共实例id，后面IOT官网地址（固定）</p></blockquote><p>在zzyl-framework中新增AliIoTConfigProperties来读取配置文件</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>properties</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Getter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Setter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">ToString</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@ToString</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;zzyl.aliyun&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliIoTConfigProperties</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * 访问Key
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> accessKeyId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 访问秘钥
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> accessKeySecret<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 区域id
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> regionId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 实例id
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> iotInstanceId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 域名
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> host<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 消费组
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> consumerGroupId<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在zzyl-service中添加如下配置：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>iot20180120<span class="token punctuation">.</span></span><span class="token class-name">Client</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>teaopenapi<span class="token punctuation">.</span>models<span class="token punctuation">.</span></span><span class="token class-name">Config</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">AliIoTConfigProperties</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IotClientConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AliIoTConfigProperties</span> aliIoTConfigProperties<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * LTAI5tDQKg9F61aJhbmhqVRK
     * LYUKZH7HQGBoD025pmSq0fQsREaOYD
     * <span class="token keyword">@return</span>
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Client</span> <span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span>accessKeyId <span class="token operator">=</span> aliIoTConfigProperties<span class="token punctuation">.</span><span class="token function">getAccessKeyId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span>accessKeySecret <span class="token operator">=</span> aliIoTConfigProperties<span class="token punctuation">.</span><span class="token function">getAccessKeySecret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 您的可用区ID 默认上海</span>
        config<span class="token punctuation">.</span>regionId <span class="token operator">=</span> aliIoTConfigProperties<span class="token punctuation">.</span><span class="token function">getRegionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Client</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试，在zzyl-web模块下创建单元测试，如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>service<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>iot20180120<span class="token punctuation">.</span></span><span class="token class-name">Client</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>iot20180120<span class="token punctuation">.</span>models<span class="token punctuation">.</span></span><span class="token class-name">QueryProductListRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>iot20180120<span class="token punctuation">.</span>models<span class="token punctuation">.</span></span><span class="token class-name">QueryProductListResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">AliIoTConfigProperties</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IoTDeviceTest</span> <span class="token punctuation">{</span>


    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">Client</span> client<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AliIoTConfigProperties</span> aliIoTConfigProperties<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 查询公共实例下的所有产品
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectProduceList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

        <span class="token class-name">QueryProductListRequest</span> queryProductListRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryProductListRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//分页条件</span>
        queryProductListRequest<span class="token punctuation">.</span><span class="token function">setPageSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        queryProductListRequest<span class="token punctuation">.</span><span class="token function">setCurrentPage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//公共实例</span>
        queryProductListRequest<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>aliIoTConfigProperties<span class="token punctuation">.</span><span class="token function">getIotInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//查询公共实例下的所有产品</span>
        <span class="token class-name">QueryProductListResponse</span> queryProductListResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">queryProductList</span><span class="token punctuation">(</span>queryProductListRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//打印数据</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>queryProductListResponse<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试结果如下</p><figure><img src="`+C+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_3-5-功能实现" tabindex="-1"><a class="header-anchor" href="#_3-5-功能实现" aria-hidden="true">#</a> 3.5 功能实现</h3><h4 id="_3-5-1-查询所有产品列表" tabindex="-1"><a class="header-anchor" href="#_3-5-1-查询所有产品列表" aria-hidden="true">#</a> 3.5.1 查询所有产品列表</h4>',20),gn={href:"https://help.aliyun.com/zh/iot/developer-reference/api-f8df77#reference-tts-44z-wdb",target:"_blank",rel:"noopener noreferrer"},yn=p(`<p>因为我们目前使用的是SDK集成开发，现在重点关注的是接口文档中的入参和出参。</p><ul><li></li></ul><p>必要的入参：</p><ul><li>CurrentPage   当前页</li><li>PageSize  每页显示条数</li><li>IotInstanceId  公共实例ID</li><li></li></ul><p>出参：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;Data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;PageCount&quot;</span><span class="token operator">:</span> <span class="token number">92</span><span class="token punctuation">,</span> 
    <span class="token property">&quot;PageSize&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> 
    <span class="token property">&quot;List&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;ProductInfo&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;DataFormat&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;ProductKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a1A0D4t****&quot;</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;NodeType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;ProductName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;路灯产品&quot;</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;DeviceCount&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;GmtCreate&quot;</span><span class="token operator">:</span> <span class="token number">1569233025000</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;AuthType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;secret&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span>
          <span class="token property">&quot;DataFormat&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;ProductKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a1dEvuQ****&quot;</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;NodeType&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;ProductName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;子设备custom&quot;</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;DeviceCount&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;GmtCreate&quot;</span><span class="token operator">:</span> <span class="token number">1568690432000</span><span class="token punctuation">,</span>
          <span class="token property">&quot;AuthType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;secret&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token property">&quot;CurrentPage&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
    <span class="token property">&quot;Total&quot;</span><span class="token operator">:</span> <span class="token number">184</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;RequestId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4B4ECF2C-6222-42EC-A4B5-C12202E71CEA&quot;</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;Success&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（1）接口定义</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/iot&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token string">&quot;智能监控管理相关接口&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeviceController</span> <span class="token keyword">extends</span> <span class="token class-name">BaseController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">Client</span> client<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${zzyl.aliyun.iotInstanceId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> iotInstanceId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/QueryProductList&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;查看所有产品列表&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;查看所有产品列表&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">queryProductList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryProductListRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        request<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>iotInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QueryProductListResponse</span> queryProductListResponse <span class="token operator">=</span>
                client<span class="token punctuation">.</span><span class="token function">queryProductList</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>queryProductListResponse<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li></li></ul><p>我们可以直接使用sdk中的QueryProductListRequest来去接收参数，其中的公共实例ID可以在后端设置，分页数据可以让前端传过来</p><ul><li></li></ul><p>因为查询产品只需要调用远程接口即可查询出来，无需操作本地数据库，所以，没有业务层代码</p><p>（2）测试</p><p>在页面中查看产品列表</p><figure><img src="`+N+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_3-5-2-新增设备" tabindex="-1"><a class="header-anchor" href="#_3-5-2-新增设备" aria-hidden="true">#</a> 3.5.2 新增设备</h4><p>实现思路</p><figure><img src="'+j+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>（1）接口定义</p><p>在DeviceController中定义新的方法，如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/RegisterDevice&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;单个注册设备&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;单个注册设备&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">registerDevice</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">DeviceDto</span> deviceDto<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>DeviceDto</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>dto</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>iot20180120<span class="token punctuation">.</span>models<span class="token punctuation">.</span></span><span class="token class-name">RegisterDeviceRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>tea<span class="token punctuation">.</span></span><span class="token class-name">NameInMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>base<span class="token punctuation">.</span></span><span class="token class-name">BaseDto</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiModelProperty</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeviceDto</span> <span class="token keyword">extends</span> <span class="token class-name">BaseDto</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;注册参数&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">RegisterDeviceRequest</span> registerDeviceRequest<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;IotId&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> iotId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;Nickname&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> nickname<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NameInMap</span><span class="token punctuation">(</span><span class="token string">&quot;ProductKey&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> productKey<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;产品名称&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> productName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;位置名称回显字段&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> deviceDescription<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;位置类型&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">Integer</span> locationType<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;绑定位置&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">Long</span> bindingLocation<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;设备名称&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> deviceName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;物理位置类型&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">Integer</span> physicalLocationType<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;设备ID&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> deviceId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（2）mapper</p><p>新增DeviceMapper</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>mapper</span><span class="token punctuation">;</span>


<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DeviceMapper</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Device</span> record<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>映射文件</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.zzyl.mapper.DeviceMapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BaseResultMap<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.zzyl.vo.DeviceVo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>device_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VARCHAR<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deviceId<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>binding_location<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VARCHAR<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bindingLocation<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>location_type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INTEGER<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>locationType<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>physical_location_type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INTEGER<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>physicalLocationType<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>device_name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VARCHAR<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deviceName<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>device_description<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VARCHAR<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deviceDescription<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>create_time<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>TIMESTAMP<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>createTime<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>update_time<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>TIMESTAMP<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateTime<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product_key<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VARCHAR<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productKey<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VARCHAR<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productKey<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>produce_name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productName<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>note_name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nickname<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>create_by<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>createBy<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>update_by<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateBy<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remark<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VARCHAR<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remark<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sql</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Base_Column_List<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    id, device_id, binding_location, location_type, physical_location_Type, device_name, 
    device_description, create_time, update_time, is_deleted, create_by, update_by, remark
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sql</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>insert<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.zzyl.entity.Device<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selectKey</span> <span class="token attr-name">keyProperty</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">order</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>AFTER<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.lang.Long<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      SELECT LAST_INSERT_ID()
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selectKey</span><span class="token punctuation">&gt;</span></span>
    insert into device (device_id, binding_location, location_type, 
      physical_location_Type, device_name, device_description, note_name, product_id, produce_name,
      create_time, update_time, is_deleted, 
      create_by, update_by, remark
      )
    values (#{deviceId,jdbcType=VARCHAR}, #{bindingLocation,jdbcType=VARCHAR}, #{locationType,jdbcType=INTEGER}, 
      #{physicalLocationType,jdbcType=INTEGER}, #{deviceName,jdbcType=VARCHAR}, #{deviceDescription,jdbcType=VARCHAR},
    #{noteName,jdbcType=VARCHAR},#{productId,jdbcType=VARCHAR},#{productName,jdbcType=VARCHAR},
    #{createTime,jdbcType=TIMESTAMP}, #{updateTime,jdbcType=TIMESTAMP}, #{isDeleted,jdbcType=BIT},
      #{createBy,jdbcType=BIGINT}, #{updateBy,jdbcType=BIGINT}, #{remark,jdbcType=VARCHAR}
      )
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>
 

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（3）业务层</p><p>新增DeviceService</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>iot20180120<span class="token punctuation">.</span>models<span class="token punctuation">.</span></span><span class="token class-name">DeleteDeviceRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>iot20180120<span class="token punctuation">.</span>models<span class="token punctuation">.</span></span><span class="token class-name">QueryDeviceDetailRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>iot20180120<span class="token punctuation">.</span>models<span class="token punctuation">.</span></span><span class="token class-name">QueryDeviceRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>base<span class="token punctuation">.</span></span><span class="token class-name">PageResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>dto<span class="token punctuation">.</span></span><span class="token class-name">DeviceDto</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">DeviceVo</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DeviceService</span> <span class="token punctuation">{</span>


    <span class="token doc-comment comment">/**
     * 注册设备
     * <span class="token keyword">@param</span> <span class="token parameter">deviceDto</span>
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerDevice</span><span class="token punctuation">(</span><span class="token class-name">DeviceDto</span> deviceDto<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实现方法：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzyl<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeviceServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">DeviceService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">Client</span> client<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">DeviceMapper</span> deviceMapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${zzyl.aliyun.iotInstanceId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> iotInstanceId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerDevice</span><span class="token punctuation">(</span><span class="token class-name">DeviceDto</span> deviceDto<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">RegisterDeviceRequest</span> request <span class="token operator">=</span> deviceDto<span class="token punctuation">.</span><span class="token function">getRegisterDeviceRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>iotInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RegisterDeviceResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">registerDevice</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token constant">TRUE</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 保存位置</span>
            <span class="token class-name">Device</span> device <span class="token operator">=</span> <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">toBean</span><span class="token punctuation">(</span>deviceDto<span class="token punctuation">,</span> <span class="token class-name">Device</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            device<span class="token punctuation">.</span><span class="token function">setDeviceId</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getIotId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            device<span class="token punctuation">.</span><span class="token function">setProductId</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getProductKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            device<span class="token punctuation">.</span><span class="token function">setNoteName</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getNickname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">QueryProductRequest</span> productRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryProductRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            productRequest<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>iotInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            productRequest<span class="token punctuation">.</span><span class="token function">setProductKey</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getProductKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">QueryProductResponse</span> queryProductResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">queryProduct</span><span class="token punctuation">(</span>productRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> productName <span class="token operator">=</span> queryProductResponse<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProductName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            device<span class="token punctuation">.</span><span class="token function">setProductName</span><span class="token punctuation">(</span>productName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getLocationType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                device<span class="token punctuation">.</span><span class="token function">setPhysicalLocationType</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                deviceMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">DeleteDeviceRequest</span> deleteDeviceRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteDeviceRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deleteDeviceRequest<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>iotInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                deleteDeviceRequest<span class="token punctuation">.</span><span class="token function">setDeviceName</span><span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getDeviceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deleteDeviceRequest<span class="token punctuation">.</span><span class="token function">setIotId</span><span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getDeviceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deleteDeviceRequest<span class="token punctuation">.</span><span class="token function">setProductKey</span><span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                client<span class="token punctuation">.</span><span class="token function">deleteDevice</span><span class="token punctuation">(</span>deleteDeviceRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BaseException</span><span class="token punctuation">(</span><span class="token string">&quot;该老人/位置已绑定该产品，请重新选择&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BaseException</span><span class="token punctuation">(</span><span class="token string">&quot;设备名称已存在，请重新输入&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（4）控制层</p><p>补全控制层代码：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Resource</span>
<span class="token keyword">private</span> <span class="token class-name">DeviceService</span> deviceService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/RegisterDevice&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;单个注册设备&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;单个注册设备&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">registerDevice</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">DeviceDto</span> deviceDto<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    deviceService<span class="token punctuation">.</span><span class="token function">registerDevice</span><span class="token punctuation">(</span>deviceDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（5）测试</p><p>在页面中创建成功以后，可以在阿里云IOT平台进行查看，同时在数据库中也保存了一份</p><h4 id="_3-5-3-查询所有设备" tabindex="-1"><a class="header-anchor" href="#_3-5-3-查询所有设备" aria-hidden="true">#</a> 3.5.3 查询所有设备</h4><p>实现思路</p><figure><img src="`+x+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>（1）接口定义</p><p>在DeviceController中定义新的方法：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/QueryDevice&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;查看所有设备&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;查看所有产品列表&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PageResponse</span><span class="token punctuation">&lt;</span><span class="token class-name">DeviceVo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryDevice</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryDeviceRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
   
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（2）mapper</p><p>在DeviceMapper中新增方法</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>List&lt;DeviceVo&gt; selectByDeviceIds(List&lt;String&gt; list);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>映射文件</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectByDeviceIds<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BaseResultMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  select
  d.*
  , tu.real_name as creator
  from device d
  left join sys_user tu on tu.id = d.create_by
  where device_id  in
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    #{id}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（3）业务层</p><p>在DeviceService中新增方法，如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 查询设备
 * <span class="token keyword">@param</span> <span class="token parameter">request</span>
 * <span class="token keyword">@return</span>
 * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
 */</span>
<span class="token keyword">public</span> <span class="token class-name">PageResponse</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DeviceVo</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryDevice</span><span class="token punctuation">(</span><span class="token class-name">QueryDeviceRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实现方法：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageResponse</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DeviceVo</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryDevice</span><span class="token punctuation">(</span><span class="token class-name">QueryDeviceRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    request<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>iotInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">QueryDeviceResponse</span> queryDeviceResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">queryDevice</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">QueryDeviceResponseBody</span> body <span class="token operator">=</span> queryDeviceResponse<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token constant">TRUE</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span><span class="token function">getSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> body<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">QueryDeviceResponseBody<span class="token punctuation">.</span>QueryDeviceResponseBodyDataDeviceInfo</span><span class="token punctuation">&gt;</span></span> deviceInfo <span class="token operator">=</span> body<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeviceInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>deviceInfo<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> deviceInfo<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">QueryDeviceResponseBody<span class="token punctuation">.</span>QueryDeviceResponseBodyDataDeviceInfo</span><span class="token operator">::</span><span class="token function">getIotId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DeviceVo</span><span class="token punctuation">&gt;</span></span> devices <span class="token operator">=</span> deviceMapper<span class="token punctuation">.</span><span class="token function">selectByDeviceIds</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">DeviceVo</span><span class="token punctuation">&gt;</span></span> deviceMap <span class="token operator">=</span> devices<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">DeviceVo</span><span class="token operator">::</span><span class="token function">getDeviceId</span><span class="token punctuation">,</span> v <span class="token operator">-&gt;</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DeviceVo</span><span class="token punctuation">&gt;</span></span> deviceVoList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            deviceInfo<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>d<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ObjectUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>deviceVoMap<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">ObjectUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>deviceVoMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getIotId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">DeviceVo</span> deviceVo <span class="token operator">=</span> deviceVoMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getIotId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span>deviceVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    deviceVoList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>deviceVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">PageResponse</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>deviceVoList<span class="token punctuation">,</span> body<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> body<span class="token punctuation">.</span><span class="token function">getPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>body<span class="token punctuation">.</span><span class="token function">getPageCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>body<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（4）控制层</p><p>补全控制层代码：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/QueryDevice&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;查看所有设备&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;查看所有产品列表&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PageResponse</span><span class="token punctuation">&lt;</span><span class="token class-name">DeviceVo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryDevice</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryDeviceRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">PageResponse</span> pageResponse <span class="token operator">=</span> deviceService<span class="token punctuation">.</span><span class="token function">queryDevice</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>pageResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（5）测试</p><p>在页面中查看效果</p><figure><img src="`+M+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_3-5-4-查询设备的详细信息" tabindex="-1"><a class="header-anchor" href="#_3-5-4-查询设备的详细信息" aria-hidden="true">#</a> 3.5.4 查询设备的详细信息</h4><p>（1）接口定义</p><p>在DeviceController中新增方法，如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/QueryDeviceDetail&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;查询指定设备的详细信息&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;查询指定设备的详细信息&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">queryDeviceDetail</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryDeviceDetailRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（2）业务层</p><p>在DeviceService新增方法，如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* 查询设备详情
* <span class="token keyword">@param</span> <span class="token parameter">request</span>
* <span class="token keyword">@return</span>
* <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
*/</span>
<span class="token keyword">public</span> <span class="token class-name">DeviceVo</span> <span class="token function">queryDeviceDetail</span><span class="token punctuation">(</span><span class="token class-name">QueryDeviceDetailRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实现方法：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* 查询设备详情
* <span class="token keyword">@param</span> <span class="token parameter">request</span>
* <span class="token keyword">@return</span>
* <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
*/</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">DeviceVo</span> <span class="token function">queryDeviceDetail</span><span class="token punctuation">(</span><span class="token class-name">QueryDeviceDetailRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    request<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>iotInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">QueryDeviceDetailResponse</span> queryDeviceDetailResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">queryDeviceDetail</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token constant">TRUE</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>queryDeviceDetailResponse<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">QueryDeviceDetailResponseBody<span class="token punctuation">.</span>QueryDeviceDetailResponseBodyData</span> data <span class="token operator">=</span> queryDeviceDetailResponse<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DeviceVo</span> deviceVo <span class="token operator">=</span> <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">toBean</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token class-name">DeviceVo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DeviceVo</span><span class="token punctuation">&gt;</span></span> devices <span class="token operator">=</span> deviceMapper<span class="token punctuation">.</span><span class="token function">selectByDeviceIds</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">getIotId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>devices<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>devices<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> deviceVo<span class="token punctuation">,</span> <span class="token class-name">CopyOptions</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ignoreNullValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            deviceVo<span class="token punctuation">.</span><span class="token function">setIotId</span><span class="token punctuation">(</span>deviceVo<span class="token punctuation">.</span><span class="token function">getDeviceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> deviceVo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BaseException</span><span class="token punctuation">(</span>queryDeviceDetailResponse<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getErrorMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（3）控制层</p><p>补全控制层代码</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/QueryDeviceDetail&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;查询指定设备的详细信息&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;查询指定设备的详细信息&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">queryDeviceDetail</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryDeviceDetailRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">DeviceVo</span> deviceVo <span class="token operator">=</span> deviceService<span class="token punctuation">.</span><span class="token function">queryDeviceDetail</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>deviceVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（4）测试</p><p>在页面中查看设备的详情数据</p><figure><img src="`+P+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_3-5-5-查询设备的状态" tabindex="-1"><a class="header-anchor" href="#_3-5-5-查询设备的状态" aria-hidden="true">#</a> 3.5.5 查询设备的状态</h4><p>在DeviceController中新增方法，如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/QueryDevicePropertyStatus&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;查询指定设备的状态&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;查询指定设备的状态&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token class-name">QueryDevicePropertyStatus</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryDevicePropertyStatusRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    request<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>iotInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">QueryDevicePropertyStatusResponse</span> deviceStatus <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">queryDevicePropertyStatus</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>deviceStatus<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在页面中查看效果</p><figure><img src="`+S+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_3-5-6-查询物模型功能列表" tabindex="-1"><a class="header-anchor" href="#_3-5-6-查询物模型功能列表" aria-hidden="true">#</a> 3.5.6 查询物模型功能列表</h4><p>在DeviceController中新增方法，如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/QueryThingModelPublished&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;查看指定产品的已发布物模型中的功能定义详情&quot;</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">&quot;查看指定产品的已发布物模型中的功能定义详情&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">queryThingModelPublished</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryThingModelPublishedRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    request<span class="token punctuation">.</span><span class="token function">setIotInstanceId</span><span class="token punctuation">(</span>iotInstanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">QueryThingModelPublishedResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">queryThingModelPublished</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在页面中查看效果</p><figure><img src="`+O+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_3-5-7-修改设备" tabindex="-1"><a class="header-anchor" href="#_3-5-7-修改设备" aria-hidden="true">#</a> 3.5.7 修改设备</h4><p>自己实现</p><h4 id="_3-5-8-删除设备" tabindex="-1"><a class="header-anchor" href="#_3-5-8-删除设备" aria-hidden="true">#</a> 3.5.8 删除设备</h4><p>自己实现</p><h2 id="_4-今日作业" tabindex="-1"><a class="header-anchor" href="#_4-今日作业" aria-hidden="true">#</a> 4 今日作业</h2><p>完成设备管理中的其他接口开发</p>',91);function qn(hn,fn){const a=o("ExternalLinkIcon");return c(),i("div",null,[U,n("p",null,[s("产品文档："),n("a",B,[s("https://help.aliyun.com/zh/iot/product-overview/?spm=a2c4g.11186623.0.0.32d844a6NPRO9e"),t(a)])]),V,n("p",null,[s("前往"),n("a",K,[s("阿里云官网"),t(a)]),s("注册账号。如果已有注册账号，请跳过此步骤。")]),Q,n("p",null,[n("a",F,[s("https://help.aliyun.com/zh/iot/user-guide/create-a-product?spm=a2c4g.11186623.0.0.6ac7133dbo6zWV"),t(a)])]),H,n("p",null,[n("a",G,[s("https://help.aliyun.com/zh/iot/user-guide/add-a-tsl-feature?spm=a2c4g.11186623.0.0.9abf6ec2jkNsER"),t(a)])]),Y,n("p",null,[n("a",J,[s("https://help.aliyun.com/zh/iot/user-guide/create-a-device?spm=a2c4g.11186623.0.0.4f1b12ackrzdOs"),t(a)])]),Z,n("p",null,[n("a",$,[s("https://help.aliyun.com/zh/iot/user-guide/devices-retrieve-certificates/?spm=a2c4g.11186623.0.0.671b53felMSmzL"),t(a)])]),W,n("p",null,[n("a",X,[s("https://help.aliyun.com/zh/iot/developer-reference/list-of-operations-by-function?spm=a2c4g.11186623.0.0.23ba960eDJ24rh"),t(a)])]),nn,n("ul",null,[n("li",null,[sn,n("ul",null,[n("li",null,[n("a",an,[s("QueryProductList"),t(a)]),s("：查询产品列表。")])])]),n("li",null,[tn,n("ul",null,[n("li",null,[n("a",pn,[s("RegisterDevice"),t(a)]),s("：注册单个设备")]),n("li",null,[n("a",en,[s("QueryDeviceDetail"),t(a)]),s("：查询设备详情")]),n("li",null,[n("a",on,[s("QueryDevice"),t(a)]),s("：查询产品的设备列表")]),n("li",null,[n("a",cn,[s("GetDeviceStatus"),t(a)]),s("：查询设备的运行状态")]),n("li",null,[n("a",ln,[s("DeleteDevice"),t(a)]),s("：删除设备")]),n("li",null,[n("a",un,[s("BatchUpdateDeviceNickname"),t(a)]),s("：修改设备")])])]),n("li",null,[rn,n("ul",null,[n("li",null,[n("a",kn,[s("QueryThingModelPublished"),t(a)]),s("：查看指定产品的已发布物模型中的功能定义详情。")])])])]),dn,vn,n("p",null,[n("a",mn,[s("https://help.aliyun.com/zh/iot/developer-reference/use-iot-platform-sdk-for-java-1?spm=a2c4g.11186623.0.0.4de85c09n2V2vb"),t(a)])]),bn,n("p",null,[s("IOT接口文档："),n("a",gn,[s("https://help.aliyun.com/zh/iot/developer-reference/api-f8df77#reference-tts-44z-wdb"),t(a)])]),yn])}const Tn=e(z,[["render",qn],["__file","day12-物联网智能监测-IOT产品设备管理.html.vue"]]);export{Tn as default};
