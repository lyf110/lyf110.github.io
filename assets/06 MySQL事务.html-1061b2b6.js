import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{o as n,c as a,e}from"./app-5f6064b2.js";const t="/assets/202210091817829-090ef1b4.jpeg",p="/assets/202210091818472-74bceb6c.png",o="/assets/202210091818659-432417b8.jpeg",i="/assets/202210091818964-91685d12.png",c="/assets/202210091820031-37acc481.jpg",l="/assets/202210091820015-aaa53607.jpeg",r="data:image/png;base64,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",d="data:image/png;base64,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",u="/assets/202210091937899-9ef08980.png",k="/assets/202210091938593-e412c43c.jpeg",m="/assets/202210091939237-d610a9fe.png",g="/assets/202210091943275-b8ad9752.jpeg",v={},h=e('<h2 id="_6-事务" tabindex="-1"><a class="header-anchor" href="#_6-事务" aria-hidden="true">#</a> 6. 事务</h2><h3 id="_6-1-事务简介" tabindex="-1"><a class="header-anchor" href="#_6-1-事务简介" aria-hidden="true">#</a> 6.1 事务简介</h3><p>事务是一组操作的集合，它是一个不可分割的工作单位，事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p><p>就比如: 张三给李四转账1000块钱，张三银行账户的钱减少1000，而李四银行账户的钱要增加</p><p>1000。 这一组操作就必须在一个事务的范围内，要么都成功，要么都失败。</p><figure><img src="'+t+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>正常情况: 转账这个操作, 需要分为以下这么三步来完成 , 三步完成之后, 张三减少1000, 而李四 增加1000, 转账成功 :</p><p><img src="'+p+'" alt="" loading="lazy"> <img src="'+o+'" alt="" loading="lazy"></p><p>异常情况: 转账这个操作, 也是分为以下这么三步来完成 , 在执行第三步是报错了, 这样就导致张三减少1000块钱, 而李四的金额没变, 这样就造成了数据的不一致, 就出现问题了。</p><figure><img src="'+i+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+c+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>为了解决上述的问题，就需要通过数据的事务来完成，我们只需要在业务逻辑执行之前开启事务，执行完毕后提交事务。如果执行过程中报错，则回滚事务，把数据恢复到事务开始之前的状态。</p><figure><img src="'+l+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>注意： 默认MySQL的事务是自动提交的，也就是说，当执行完一条DML语句时，MySQL会立即隐式的提交事务。</p></blockquote><h3 id="_6-2-事务操作" tabindex="-1"><a class="header-anchor" href="#_6-2-事务操作" aria-hidden="true">#</a> 6.2 事务操作</h3><p>数据准备：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 删除account表	</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span>	<span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">\`</span>account<span class="token punctuation">\`</span></span><span class="token punctuation">;</span>

<span class="token comment">-- 创建account表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">\`</span>account<span class="token punctuation">\`</span></span> <span class="token punctuation">(</span> 
<span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span> <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ID&#39;</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">\`</span>name<span class="token punctuation">\`</span></span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span> <span class="token number">10</span> <span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">\`</span>money<span class="token punctuation">\`</span></span> <span class="token keyword">DOUBLE</span> <span class="token punctuation">(</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;余额&#39;</span> 
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;账户表&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 插入数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">\`</span>account<span class="token punctuation">\`</span></span> <span class="token punctuation">(</span> <span class="token identifier"><span class="token punctuation">\`</span>name<span class="token punctuation">\`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">\`</span>money<span class="token punctuation">\`</span></span> <span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
	<span class="token punctuation">(</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token number">2000</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token number">2000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-2-1-未控制事务" tabindex="-1"><a class="header-anchor" href="#_6-2-1-未控制事务" aria-hidden="true">#</a> 6.2.1 未控制事务</h4><p>1). 测试正常情况</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1. 查询张三余额</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 2. 张三的余额减少1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 3. 李四的余额增加1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试完毕之后检查数据的状态, 可以看到数据操作前后是一致的。</p><figure><img src="`+r+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>2). 测试异常情况</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1. 查询张三余额</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 2. 张三的余额减少1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">;</span>
出错了<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">-- 3. 李四的余额增加1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们把数据都恢复到2000， 然后再次一次性执行上述的SQL语句(出错了.... 这句话不符合SQL语法,执行就会报错)，检查最终的数据情况, 发现数据在操作前后不一致了。</p><figure><img src="`+d+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_6-2-2-控制事务一" tabindex="-1"><a class="header-anchor" href="#_6-2-2-控制事务一" aria-hidden="true">#</a> 6.2.2 控制事务一</h4><p>1). 查看/设置事务提交方式</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> @<span class="token variable">@autocommit</span> <span class="token punctuation">;</span>
<span class="token keyword">SET</span> @<span class="token variable">@autocommit</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2). 提交事务</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>3). 回滚事务</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>注意：上述的这种方式，我们是修改了事务的自动提交行为, 把默认的自动提交修改为了手动提交, 此时我们执行的DML语句都不会提交, 需要手动的执行commit进行提交。</p></blockquote><h4 id="_6-2-3-控制事务二" tabindex="-1"><a class="header-anchor" href="#_6-2-3-控制事务二" aria-hidden="true">#</a> 6.2.3 控制事务二</h4><p>1). 开启事务</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span> 或 <span class="token keyword">BEGIN</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2). 提交事务</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>3). 回滚事务</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_6-2-4-转账案例" tabindex="-1"><a class="header-anchor" href="#_6-2-4-转账案例" aria-hidden="true">#</a> 6.2.4 转账案例：</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 开启事务</span>
<span class="token keyword">start</span> <span class="token keyword">transaction</span>
<span class="token comment">-- 1. 查询张三余额</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 2. 张三的余额减少1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 3. 李四的余额增加1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 如果正常执行完毕, 则提交事务</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
<span class="token comment">-- 如果执行过程中报错, 则回滚事务</span>
<span class="token comment">-- rollback;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-3-事务四大特性" tabindex="-1"><a class="header-anchor" href="#_6-3-事务四大特性" aria-hidden="true">#</a> 6.3 事务四大特性</h3><ul><li>原子性（Atomicity）：事务是不可分割的最小操作单元，要么全部成功，要么全部失败。</li><li>一致性（Consistency）：事务完成时，必须使所有的数据都保持一致状态。</li><li>隔离性（Isolation）：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行。</li><li>持久性（Durability）：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。</li></ul><p>上述就是事务的四大特性，简称ACID。</p><figure><img src="`+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_6-4-并发事务问题" tabindex="-1"><a class="header-anchor" href="#_6-4-并发事务问题" aria-hidden="true">#</a> 6.4 并发事务问题</h3><h4 id="_1-赃读-一个事务读到另外一个事务还没有提交的数据。" tabindex="-1"><a class="header-anchor" href="#_1-赃读-一个事务读到另外一个事务还没有提交的数据。" aria-hidden="true">#</a> 1). 赃读：一个事务读到另外一个事务还没有提交的数据。</h4><figure><img src="'+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>比如B读取到了A未提交的数据。</p><h4 id="_2-不可重复读-一个事务先后读取同一条记录-但两次读取的数据不同-称之为不可重复读。" tabindex="-1"><a class="header-anchor" href="#_2-不可重复读-一个事务先后读取同一条记录-但两次读取的数据不同-称之为不可重复读。" aria-hidden="true">#</a> 2). 不可重复读：一个事务先后读取同一条记录，但两次读取的数据不同，称之为不可重复读。</h4><figure><img src="'+m+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>事务A两次读取同一条记录，但是读取到的数据却是不一样的。</p><h4 id="_3-幻读-一个事务按照条件查询数据时-没有对应的数据行-但是在插入数据时-又发现这行数据已经存在-好像出现了-幻影-。" tabindex="-1"><a class="header-anchor" href="#_3-幻读-一个事务按照条件查询数据时-没有对应的数据行-但是在插入数据时-又发现这行数据已经存在-好像出现了-幻影-。" aria-hidden="true">#</a> 3). 幻读：一个事务按照条件查询数据时，没有对应的数据行，但是在插入数据时，又发现这行数据已经存在，好像出现了 &quot;幻影&quot;。</h4><figure><img src="'+g+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_6-5-事务隔离级别" tabindex="-1"><a class="header-anchor" href="#_6-5-事务隔离级别" aria-hidden="true">#</a> 6.5 事务隔离级别</h3><p>为了解决并发事务所引发的问题，在数据库中引入了事务隔离级别。主要有以下几种：</p><table><thead><tr><th><strong>隔离级别</strong></th><th><strong>脏读</strong></th><th><strong>不可重复读</strong></th><th><strong>幻读</strong></th></tr></thead><tbody><tr><td>Read uncommitted</td><td>√</td><td>√</td><td>√</td></tr><tr><td>Read committed</td><td>×</td><td>√</td><td>√</td></tr><tr><td>Repeatable Read(默认)</td><td>×</td><td>×</td><td>√</td></tr><tr><td>Serializable</td><td>×</td><td>×</td><td>×</td></tr></tbody></table><h4 id="_1-查看事务隔离级别" tabindex="-1"><a class="header-anchor" href="#_1-查看事务隔离级别" aria-hidden="true">#</a> 1). 查看事务隔离级别</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> @<span class="token variable">@TRANSACTION_ISOLATION</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2-设置事务隔离级别" tabindex="-1"><a class="header-anchor" href="#_2-设置事务隔离级别" aria-hidden="true">#</a> 2). 设置事务隔离级别</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token punctuation">[</span> <span class="token keyword">SESSION</span> <span class="token operator">|</span> <span class="token keyword">GLOBAL</span> <span class="token punctuation">]</span> <span class="token keyword">TRANSACTION</span> <span class="token keyword">ISOLATION</span> <span class="token keyword">LEVEL</span> { <span class="token keyword">READ</span> <span class="token keyword">UNCOMMITTED</span> <span class="token operator">|</span> <span class="token keyword">READ</span> <span class="token keyword">COMMITTED</span> <span class="token operator">|</span> <span class="token keyword">REPEATABLE</span> <span class="token keyword">READ</span> <span class="token operator">|</span> <span class="token keyword">SERIALIZABLE</span> }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>注意：事务隔离级别越高，数据越安全，但是性能越低。</p></blockquote>`,64),b=[h];function A(y,w){return n(),a("div",null,b)}const R=s(v,[["render",A],["__file","06 MySQL事务.html.vue"]]);export{R as default};
