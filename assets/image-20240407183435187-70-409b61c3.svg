<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="889px" preserveAspectRatio="none" style="width:739px;height:889px;background:#FFFFFF;" version="1.1" viewBox="0 0 739 889" width="739px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="130.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="252" y="112.4297"/><rect fill="#FFFFFF" height="317.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="252" y="473.0234"/><rect fill="#FFFFFF" height="171.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="525" y="272.2266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="22" x2="22" y1="81.2969" y2="808.4844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="257" x2="257" y1="81.2969" y2="808.4844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="530" x2="530" y1="81.2969" y2="808.4844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="706.5" x2="706.5" y1="81.2969" y2="808.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="5" y="77.9951">前端</text><ellipse cx="22" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22,21.5 L22,48.5 M9,29.5 L35,29.5 M22,48.5 L9,63.5 M22,48.5 L35,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="5" y="820.4795">前端</text><ellipse cx="22" cy="832.2813" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22,840.2813 L22,867.2813 M9,848.2813 L35,848.2813 M22,867.2813 L9,882.2813 M22,867.2813 L35,882.2813 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="222" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="229" y="69.9951">登录系统</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="222" y="807.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="229" y="827.4795">登录系统</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="495" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="502" y="69.9951">业务系统</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="495" y="807.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="502" y="827.4795">业务系统</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="680.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="687.5" y="69.9951">Redis</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="680.5" y="807.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="687.5" y="827.4795">Redis</text><rect fill="#FFFFFF" height="130.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="252" y="112.4297"/><rect fill="#FFFFFF" height="317.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="252" y="473.0234"/><rect fill="#FFFFFF" height="171.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="525" y="272.2266"/><polygon fill="#181818" points="240,108.4297,250,112.4297,240,116.4297,244,112.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="22" x2="246" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="29" y="107.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="42" y="107.3638">用户名密码</text><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="304" y1="156.6953" y2="156.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="304" x2="304" y1="156.6953" y2="169.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="263" x2="304" y1="169.6953" y2="169.6953"/><polygon fill="#181818" points="273,165.6953,263,169.6953,273,173.6953,269,169.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="269" y="144.063">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="282" y="136.4966">生成access_token、</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="282" y="151.6294">refresh_token</text><polygon fill="#181818" points="695,194.8281,705,198.8281,695,202.8281,699,198.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="701" y1="198.8281" y2="198.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="269" y="193.7622">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="282" y="193.7622">存储refresh_token到redis</text><polygon fill="#181818" points="33,239.0938,23,243.0938,33,247.0938,29,243.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="27" x2="256" y1="243.0938" y2="243.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="39" y="230.4614">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="52" y="222.895">返回access_token、</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="52" y="238.0278">refresh_token</text><polygon fill="#181818" points="513,268.2266,523,272.2266,513,276.2266,517,272.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="22" x2="519" y1="272.2266" y2="272.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="29" y="267.1606">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="42" y="267.1606">请求数据接口携带access_token</text><line style="stroke:#181818;stroke-width:1.0;" x1="535" x2="577" y1="301.3594" y2="301.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="577" x2="577" y1="301.3594" y2="314.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="536" x2="577" y1="314.3594" y2="314.3594"/><polygon fill="#181818" points="546,310.3594,536,314.3594,546,318.3594,542,314.3594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="542" y="296.2935">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="555" y="296.2935">校验token（一次校验）</text><polygon fill="#181818" points="33,339.4922,23,343.4922,33,347.4922,29,343.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="27" x2="524" y1="343.4922" y2="343.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="39" y="338.4263">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="52" y="338.4263">响应结果</text><polygon fill="#181818" points="513,368.625,523,372.625,513,376.625,517,372.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="22" x2="519" y1="372.625" y2="372.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="29" y="367.5591">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="42" y="367.5591">请求数据接口携带access_token</text><line style="stroke:#181818;stroke-width:1.0;" x1="535" x2="577" y1="401.7578" y2="401.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="577" x2="577" y1="401.7578" y2="414.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="536" x2="577" y1="414.7578" y2="414.7578"/><polygon fill="#181818" points="546,410.7578,536,414.7578,546,418.7578,542,414.7578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="542" y="396.6919">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="555" y="396.6919">校验token（一次校验）</text><polygon fill="#181818" points="33,439.8906,23,443.8906,33,447.8906,29,443.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="27" x2="529" y1="443.8906" y2="443.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="39" y="438.8247">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="61" y="438.8247">access_token失效，响应401</text><polygon fill="#181818" points="240,469.0234,250,473.0234,240,477.0234,244,473.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="22" x2="246" y1="473.0234" y2="473.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="29" y="467.9575">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="51" y="467.9575">刷新token，携带refresh_token</text><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="304" y1="502.1563" y2="502.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="304" x2="304" y1="502.1563" y2="515.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="263" x2="304" y1="515.1563" y2="515.1563"/><polygon fill="#181818" points="273,511.1563,263,515.1563,273,519.1563,269,515.1563" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="269" y="497.0903">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="291" y="497.0903">校验token（二次校验）</text><polygon fill="#181818" points="33,540.2891,23,544.2891,33,548.2891,29,544.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="27" x2="251" y1="544.2891" y2="544.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="39" y="539.2231">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="61" y="539.2231">token无效，重新登录</text><polygon fill="#181818" points="695,569.4219,705,573.4219,695,577.4219,699,573.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="701" y1="573.4219" y2="573.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="269" y="568.356">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="291" y="568.356">token有效，从redis中查询</text><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="304" y1="617.6875" y2="617.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="304" x2="304" y1="617.6875" y2="630.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="263" x2="304" y1="630.6875" y2="630.6875"/><polygon fill="#181818" points="273,626.6875,263,630.6875,273,634.6875,269,630.6875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="269" y="605.0552">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="291" y="597.4888">判断redis中存储的refresh_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="291" y="612.6216">是否已经使用（三次校验）</text><polygon fill="#181818" points="33,655.8203,23,659.8203,33,663.8203,29,659.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="27" x2="251" y1="659.8203" y2="659.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="39" y="654.7544">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="61" y="654.7544">token无效，重新登录</text><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="304" y1="704.0859" y2="704.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="304" x2="304" y1="704.0859" y2="717.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="263" x2="304" y1="717.0859" y2="717.0859"/><polygon fill="#181818" points="273,713.0859,263,717.0859,273,721.0859,269,717.0859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="269" y="691.4536">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="291" y="683.8872">token有效，重新生成access_token、</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="291" y="699.02">refresh_token</text><polygon fill="#181818" points="695,742.2188,705,746.2188,695,750.2188,699,746.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="701" y1="746.2188" y2="746.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="269" y="741.1528">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337" x="291" y="741.1528">删除旧的refresh_token，存储新的refresh_token到redis</text><polygon fill="#181818" points="33,786.4844,23,790.4844,33,794.4844,29,790.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="27" x2="256" y1="790.4844" y2="790.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="39" y="777.8521">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="61" y="770.2856">返回新的access_token、</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="61" y="785.4185">refresh_token</text></g></svg>